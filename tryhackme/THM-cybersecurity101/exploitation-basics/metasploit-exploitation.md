# Metasploit: Exploitation – Learning Report

**Author:** Antonio Pedro  

**Date:** 29/08/2025  

**Platform:** TryHackMe  

**Difficulty:** Easy  

**Tags:** #Metasploit #Exploitation #Scanning #VulnerabilityAssessment

---

## 1. Overview
This lab covered how to use Metasploit for vulnerability scanning and exploitation; understanding the database feature for penetration testing under controlled environments; and how to generate payloads with msfvenom to obtain a meterpreter session on the target system.

---

## 2. Skills Practiced

- **Port Scanning & Enumeration**
  - Identifying open ports with Nmap.
  - Using Metasploit port scanning modules.
  - Enumerating NetBIOS and HTTP services.

- **Service Identification**
  - Discovering NetBIOS names.
  - Determining HTTP versions via Metasploit auxiliary modules.

- **Brute Force & Authentication Testing**
  - Configuring the 'smb_login' module.
  - Using wordlists for credential attempts.

- **Exploitation**
  - Exploiting a known vulnerability to gain shell access.
  - Creating reverse shell payloads with 'msfvenom'.
  - Delivering payloads via a Python3 HTTP server.

- **Post-Exploitation**
  - Using 'hashdump' to extract password hashes.
  - Running post-exploitation modules to retrieve all user hashes.

- **Metasploit Workflow**
  - Searching for and selecting modules ('search', 'info').
  - Setting module options ('RHOST', 'LHOST', 'RPORT', 'LPORT', 'PASS_FILE', 'SESSION').
  - Managing sessions within msfconsole.

---

## 3. Tools Used
- **Nmap** – for initial port scanning and service discovery.  
- **Metasploit Framework (msfconsole)** – for module searching, scanning, exploitation, and post-exploitation.  
  - 'portscan' modules  
  - 'http_version' module  
  - 'smb_login' module  
  - 'hashdump' command  
- **msfvenom** – for creating a reverse shell payload.  
- **Python3 HTTP server** – for hosting and transferring a payload to a target machine.  

---

## 4. Methodology & Notes
The first task was about searching for modules, specifically portscan modules, to scan open ports on the target system. It also went over how we can use Nmap in the msfconsole prompt.

I had to determine how many ports were open on the target system, so I ran Nmap against the target's IP to find five open ports.

One of the ports was a NetBIOS port, so I searched for 'portscan netbios' in the msfconsole and proceeded to scan that port, discovering the NetBIOS name.

Then I was asked to find out more about another open port, which I did after finding the appropriate module by using the command 'search http_version'. I was able to identify which HTTP version was running on that port.

Finally, still within the first task, I was asked to obtain an SMB password. I searched for 'smb login', but this module required additional options to be configured. 

This is when I learned how to set additional values for a module, such as specifying a wordlist file with 'set PASS_FILE /path/to/wordlist.txt'.

The second task was entirely theoretical, focused on the Metasploit database. It included images showing how to use different workspaces within this feature and how scans are saved to the database for later analysis.

The third task was about using the 'info' command to learn more about the module you are working with. This helps provide a better understanding of what a module does and when it should be used.

The fourth task involved a more practical approach. 

I was tasked with exploiting a critical vulnerability on the target's VM, the same vulnerability that was demonstrated in the room's tutorial, to gain shell access and retrieve a specific file from the system. 

After that, I was asked to find the hash of another user's password on the system by using the 'hashdump' command.

For the final task I had to create a reverse shell payload using msfvenom.

I downloaded it to the remote machine via a locally hosted HTTP server, then established a session between the two machines.

After establishing the session, I leveraged a post-exploitation module to retrieve the password hashes of all users.

---

## 5. Process Summary
- Used Nmap inside msfconsole to identify open ports on the target system.  
- Leveraged Metasploit port scan modules to enumerate services, including NetBIOS, and retrieved the NetBIOS name.  
- Identified the HTTP version running on an open web port by searching and using the appropriate auxiliary module.  
- Attempted SMB authentication using the 'smb_login' module, learning how to configure it with additional options such as 'PASS_FILE' for wordlists.  
- Exploited a critical vulnerability on the target VM to gain shell access and retrieve a specific file.  
- Performed post-exploitation with the 'hashdump' command to extract another user's password hash.  
- Created a reverse shell payload using 'msfvenom', transferred it to the remote machine via a locally hosted HTTP server, and established a session.  
- Leveraged a post-exploitation module to dump the password hashes of all users on the system.  

---

### 6. Issues:
- **Room Question:** Asked to perform a post-exploitation action.  
- **Issue:** Tutorial task did not mention setting a session to complete the assignment.  

#### My Thought Process
- Initially thought: *I should background the session, load the post-exploit, and then use 'set SESSION id' to get back into meterpreter*, because I had learned about setting a session value in a previous room.
- Chose not to do this because it wasn't in the task, so I tried running the post-exploitation module directly in the meterpreter.  
- This didn't work, and I got stuck for a little while.  

#### Resolution
- After checking external write-ups, I confirmed my first instinct was correct:  
  - I needed to **background the shell**  
  - Run the module  
  - Then use 'set SESSION id' to bind it.  
  - Finally, return to meterpreter and run 'hashdump'.

#### Lesson Learned
- Tutorials may skip steps or use shortcuts: trust your reasoning if it matches the tool's logic.  
- Do not assume the tutorial workflow is exhaustive.  
- Next time, I'll test my approach and validate it before discarding it.  